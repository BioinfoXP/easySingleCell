% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/3.scRNA-Viz.R
\name{scVisRatioBox}
\alias{scVisRatioBox}
\title{scVis: Cell Proportion Boxplot with Stats}
\usage{
scVisRatioBox(
  sce,
  group_col,
  celltype_col,
  sample_col,
  comparisons = NULL,
  sign_method = "wilcox.test",
  sign_label = "p.signif",
  palette = NULL,
  pt_size = 1.5,
  box_width = 0.6,
  base_size = 14
)
}
\arguments{
\item{sce}{A Seurat object.}

\item{group_col}{String. Column name for conditions (e.g., "Treatment").}

\item{celltype_col}{String. Column name for cell types.}

\item{sample_col}{String. Column name for biological samples (e.g., "orig.ident").}

\item{comparisons}{List of vectors. Pairs to compare (e.g., \code{list(c("A", "B"))}). If NULL, performs global test.}

\item{sign_method}{String. Test method: "wilcox.test" (default), "t.test", "kruskal.test", or "anova".}

\item{sign_label}{String. Label type: "p.signif" (*) or "p.format" (numbers).}

\item{palette}{Vector. Custom colors. If NULL, uses default vibrant palette.}

\item{pt_size}{Numeric. Size of jitter points. Default 1.5.}

\item{box_width}{Numeric. Width of boxplots. Default 0.6.}

\item{base_size}{Numeric. Base font size. Default 14.}
}
\value{
A ggplot object.
}
\description{
Calculates cell type proportions per sample and performs statistical comparisons between groups using Boxplots.
Automatically handles missing cell types (fills 0) and maps samples back to their groups correctly.
Uses base R pipe (R >= 4.1.0).
}
\examples{
\dontrun{
  library(Seurat)
  library(ggplot2)

  # --- 1. Mock Data ---
  set.seed(123)
  n_cells <- 1000
  counts <- matrix(rpois(n_cells * 10, 1), nrow = 10, ncol = n_cells)
  rownames(counts) <- paste0("Gene_", 1:10)
  colnames(counts) <- paste0("Cell_", 1:n_cells)
  sce <- CreateSeuratObject(counts = counts)

  # Simulate Metadata
  sce$Group <- sample(c("Ctrl", "Treat"), n_cells, replace = TRUE)
  sce$Sample <- paste0(sce$Group, "_Rep", sample(1:3, n_cells, replace = TRUE))
  sce$CellType <- sample(c("T_cell", "B_cell", "Macro"), n_cells, replace = TRUE)

  # --- 2. Plot ---
  p <- scVisRatioBox(
    sce = sce,
    group_col = "Group",
    celltype_col = "CellType",
    sample_col = "Sample",
    comparisons = list(c("Treat", "Ctrl")), # Pairwise comparison
    sign_label = "p.signif"
  )
  print(p)
}
}
