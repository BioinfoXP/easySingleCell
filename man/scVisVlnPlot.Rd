% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/3.scRNA-Viz.R
\name{scVisVlnPlot}
\alias{scVisVlnPlot}
\title{scVis: Publication-Ready Violin Plot with Stats}
\usage{
scVisVlnPlot(
  sce,
  features,
  group_col = NULL,
  comparisons = NULL,
  palette = NULL,
  pt_size = 0,
  ncol = NULL,
  base_size = 14,
  sign_method = "wilcox.test",
  sign_label = "p.signif",
  hide_ns = TRUE,
  step_increase = 0.1,
  ...
)
}
\arguments{
\item{sce}{A Seurat object.}

\item{features}{Vector of feature names (e.g., c("TP53", "CD3D")) to plot.}

\item{group_col}{String. Column name to group cells by. If NULL, uses active identity.}

\item{comparisons}{List of vectors. Pairs of groups to compare (e.g., \code{list(c("Treat", "Ctrl"))}).}

\item{palette}{Vector. Custom colors. If NULL, uses a default vibrant NPG-style palette.}

\item{pt_size}{Numeric. Size of the jitter points. Default 0.}

\item{ncol}{Numeric. Number of columns for layout. Auto-calculated if NULL.}

\item{base_size}{Numeric. Base font size for the plot. Default 14.}

\item{sign_method}{String. Statistical test method: "wilcox.test" (default), "t.test", "kruskal.test", or "anova".}

\item{sign_label}{String. Label type: "p.signif" (stars) or "p.format" (numbers). Default "p.signif".}

\item{hide_ns}{Logical. If TRUE, only displays significant comparisons (p < 0.05). Default TRUE.}

\item{step_increase}{Numeric. Spacing between stat brackets. Default 0.1.}

\item{...}{Additional arguments passed to \code{Seurat::VlnPlot}.}
}
\value{
A patchwork ggplot object.
}
\description{
A wrapper around \code{Seurat::VlnPlot} that adds statistical comparisons and optimizes layout.
Automatically handles the common "Column not found" error in stats calculation by using the internal 'ident' column.
Uses base R pipe (R >= 4.1.0).
}
\examples{
\dontrun{
  library(Seurat)
  library(ggplot2)

  # --- 1. Mock Data (Using REAL Gene Names) ---
  set.seed(123)
  n_cells <- 300
  # Simulate 5 genes: TP53, CD3D, MS4A1, GAPDH, EGFR
  genes <- c("TP53", "CD3D", "MS4A1", "GAPDH", "EGFR")
  counts <- matrix(rpois(n_cells * 5, 1), nrow = 5, ncol = n_cells)
  rownames(counts) <- genes
  colnames(counts) <- paste0("Cell_", 1:n_cells)

  sce <- CreateSeuratObject(counts = counts)
  sce$Group <- sample(c("Ctrl", "Treat"), n_cells, replace = TRUE)

  # Simulate TP53 upregulation in Treat group
  mat <- GetAssayData(sce, slot = "counts")
  mat["TP53", sce$Group == "Treat"] <- mat["TP53", sce$Group == "Treat"] + 3
  sce <- SetAssayData(sce, slot = "counts", new.data = mat)

  # --- 2. Plot ---
  p <- scVisVlnPlot(
    sce = sce,
    features = c("TP53", "CD3D"), # Real gene symbols
    group_col = "Group",
    comparisons = list(c("Treat", "Ctrl")),
    sign_label = "p.signif",
    pt_size = 0.1
  )
  print(p)
}
}
