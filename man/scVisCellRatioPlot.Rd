% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/3.scRNA-Viz.R
\name{scVisCellRatioPlot}
\alias{scVisCellRatioPlot}
\title{Visualize Cell Type Proportion Differences}
\usage{
scVisCellRatioPlot(
  sce,
  group.by,
  cell.type = "celltype",
  sample.by = "orig.ident",
  comparisons = NULL,
  test.method = "wilcox.test",
  label.type = "p.signif",
  cols = NULL,
  pt.size = 1.5,
  width = 0.6,
  ...
)
}
\arguments{
\item{sce}{A Seurat object.}

\item{group.by}{Column name in meta.data distinguishing the conditions/groups (e.g., "Treatment", "Control").}

\item{cell.type}{Column name in meta.data representing cell types/clusters (e.g., "celltype", "seurat_clusters"). Default is "celltype".}

\item{sample.by}{Column name in meta.data representing biological replicates/samples (e.g., "orig.ident"). Default is "orig.ident".}

\item{comparisons}{A list of vectors specifying the pairs to compare (e.g., list(c("Ctrl", "Treat"))). If NULL, performs global test or pairwise against ref depending on context.}

\item{test.method}{Method for statistical test. Default "wilcox.test". Options: "t.test", "kruskal.test", "anova".}

\item{label.type}{What to show for significance. Default "p.signif" (*, **, ns). Option: "p.format" (numeric value).}

\item{cols}{Vector of colors for groups. If NULL, uses a default palette.}

\item{pt.size}{Size of the jitter points representing samples. Default 1.5.}

\item{width}{Bar/Box width. Default 0.6.}

\item{...}{Additional arguments passed to ggplot2 theme.}
}
\value{
A ggplot object with statistical annotations.
}
\description{
Calculates cell type proportions per sample and performs statistical comparisons between groups.
This function includes robust handling for missing cell types (filling with 0) to ensure accurate statistical testing.
It combines boxplots (distribution) with jitter points (individual samples) and adds statistical significance annotations using \code{ggpubr}.
}
\examples{
\dontrun{
  # 1. Basic usage: Two-group comparison (default Wilcoxon test)
  # Automatically compares groups found in "treatment" column
  scVisCellRatioPlot(sce,
                     group.by = "treatment",
                     cell.type = "cell_type",
                     sample.by = "orig.ident")

  # 2. Multi-group comparison with specific pairs
  # Useful if you have 3 groups (A, B, C) and only want to compare A vs B and A vs C
  my_comparisons <- list(c("A", "B"), c("A", "C"))

  scVisCellRatioPlot(sce,
                     group.by = "group",
                     cell.type = "cell_type",
                     sample.by = "orig.ident",
                     comparisons = my_comparisons,
                     test.method = "wilcox.test",
                     label.type = "p.signif") # Display stars (*, **, ***)

  # 3. Show numeric P-values instead of stars
  scVisCellRatioPlot(sce,
                     group.by = "treatment",
                     cell.type = "cell_type",
                     sample.by = "orig.ident",
                     label.type = "p.format") # Display value (e.g., 0.0042)
}
}
