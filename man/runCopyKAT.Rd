% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/2.scRNA-CNA-Analysis.R
\name{runCopyKAT}
\alias{runCopyKAT}
\title{Run CopyKAT by Sample}
\usage{
runCopyKAT(
  sce,
  target_class,
  ref_classes,
  sample_col = "orig.ident",
  celltype_col = "celltype",
  output_dir = "./CopyKAT",
  overwrite = FALSE,
  min_cells = 25,
  n.cores = 20,
  KS.cut = 0.1,
  ngene.chr = 5,
  win.size = 25,
  ...
)
}
\arguments{
\item{sce}{A Seurat object containing both tumor and normal/immune cells.}

\item{target_class}{String. The cell type to investigate (e.g., "Epithelial").}

\item{ref_classes}{Vector of strings. The cell types to serve as normal references (e.g., c("T_cell", "Myeloid")).}

\item{sample_col}{String. Column name for sample IDs. Default: "orig.ident".}

\item{celltype_col}{String. Column name for cell types. Default: "celltype".}

\item{output_dir}{String. Directory to save results. Default: "./CopyKAT".}

\item{overwrite}{Logical. If TRUE, re-runs CopyKAT even if output files exist. Default: FALSE.}

\item{min_cells}{Integer. Minimum number of cells required per sample. Default: 25.}

\item{n.cores}{Integer. Number of cores. Default: 20.}

\item{KS.cut}{Numeric. Segmentation sensitivity (0-1). Default: 0.1.}

\item{ngene.chr}{Integer. Min genes per chromosome. Default: 5.}

\item{win.size}{Integer. Window size. Default: 25.}

\item{...}{Additional arguments passed directly to copykat().}
}
\value{
A Seurat object with added 'copykat.pred' metadata.
}
\description{
Runs CopyKAT on a Seurat object by splitting it into samples.
}
\examples{
\dontrun{
  # 1. Basic Run (Resume mode by default)
  # It will skip samples that already have output files in ./CopyKAT
  sce_res <- runCopyKAT(
    sce = sce_full,
    target_class = "Epithelial",
    ref_classes = c("T_cell", "Myeloid")
  )

  # 2. Force Re-run (Overwrite existing results)
  # Useful if you changed parameters (e.g., KS.cut) and need to update results
  sce_res <- runCopyKAT(
    sce = sce_full,
    target_class = "Epithelial",
    ref_classes = c("T_cell"),
    overwrite = TRUE,
    n.cores = 30
  )

  # 3. Advanced Tuning
  sce_res <- runCopyKAT(
    sce = sce_full,
    target_class = "Epithelial",
    ref_classes = c("T_cell", "Macrophage"),
    KS.cut = 0.15,      # Less sensitive segmentation
    win.size = 20,      # Smaller window size
    output_dir = "./Analysis/CopyKAT_V2"
  )

  # 4. Visualization
  Seurat::DimPlot(sce_res, group.by = "copykat.pred")
}
}
